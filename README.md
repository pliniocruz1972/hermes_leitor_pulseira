# üéüÔ∏è Sistema de Entrega de Pulseiras

Sistema web m√≥vel para controle automatizado da entrega de pulseiras em eventos, com valida√ß√£o por QR Code e controle de uma entrega por dia por participante.

## üìã Descri√ß√£o

O **Sistema de Entrega de Pulseiras** √© uma aplica√ß√£o web otimizada para dispositivos m√≥veis que permite o controle eficiente da distribui√ß√£o de pulseiras em eventos. O sistema utiliza leitura de QR Code via c√¢mera do dispositivo ou entrada manual, garantindo que cada participante retire apenas uma pulseira por dia.

Desenvolvido especificamente para o **Sal√£o do Turismo**, o sistema oferece interface intuitiva, relat√≥rios em tempo real e hist√≥rico completo de entregas.

## ‚ú® Funcionalidades

### üì± **Interface Mobile-First**
- Design responsivo otimizado para smartphones
- Interface touch-friendly para opera√ß√£o r√°pida
- Funcionamento offline-first com sincroniza√ß√£o autom√°tica

### üîç **Leitura de QR Code**
- **C√¢mera integrada**: Leitura autom√°tica via c√¢mera do dispositivo
- **Entrada manual**: Campo para digita√ß√£o manual do c√≥digo
- **Valida√ß√£o em tempo real**: Verifica√ß√£o instant√¢nea da validade do c√≥digo

### üéØ **Controles de Entrega**
- **Uma pulseira por dia**: Controle r√≠gido para evitar entregas duplicadas
- **M√∫ltiplos tipos de QR**: Suporte a diferentes formatos de c√≥digos
- **Confirma√ß√£o obrigat√≥ria**: Dupla confirma√ß√£o antes da entrega
- **Registro detalhado**: Log completo com data, hora e detalhes

### üìä **Dashboard e Relat√≥rios**
- **Estat√≠sticas em tempo real**: Contadores ao vivo das entregas
- **Separa√ß√£o por tipo**: M√©tricas detalhadas por categoria de QR Code
- **Hist√≥rico recente**: Lista das √∫ltimas entregas realizadas
- **Relat√≥rios gerenciais**: Dados consolidados para an√°lise

### üîí **Seguran√ßa e Auditoria**
- **Registro de IP**: Rastreamento do dispositivo de origem
- **User Agent**: Identifica√ß√£o do navegador/dispositivo
- **Log de a√ß√µes**: Hist√≥rico completo para auditoria
- **Prote√ß√£o contra duplicatas**: Controles robustos de integridade

## üõ†Ô∏è Tecnologias

- **Backend**: PHP 7.4+
- **Frontend**: HTML5, CSS3, JavaScript (ES6+)
- **Banco de Dados**: MySQL 5.7+ / MariaDB 10.3+
- **UI Framework**: Bootstrap 5.3
- **√çcones**: Font Awesome 6.4
- **QR Code Reader**: jsQR Library
- **PWA**: Service Worker para funcionamento offline

## üìù Tipos de QR Code Suportados

| Formato | Exemplo | Status | Descri√ß√£o |
|---------|---------|--------|-----------|
| `10.CODIGO` | `10.3731452383` | ‚úÖ **Pode retirar** | C√≥digo de inscri√ß√£o v√°lido |
| `20.ID` | `20.12345678` | ‚úÖ **Pode retirar** | ID do participante (8 d√≠gitos) |
| `30.VALOR` | `30.1234567` | ‚ùå **N√£o pode retirar** | C√≥digo de palestrar/organiza√ß√£o |
| `40.VALOR` | `40.9876543` | ‚ùå **N√£o pode retirar** | C√≥digo de expositor/patrocinador |

## üöÄ Instala√ß√£o

### Pr√©-requisitos
```bash
- PHP 7.4 ou superior
- MySQL 5.7+ ou MariaDB 10.3+
- Extens√µes PHP: PDO, PDO_MySQL, JSON
- Navegador com suporte a getUserMedia() para c√¢mera
```

### Instala√ß√£o R√°pida

1. **Clone o reposit√≥rio**
```bash
git clone https://github.com/seu-usuario/sistema-pulseiras.git
cd sistema-pulseiras/pulseira
```

2. **Configure o banco de dados**
```bash
# Edite o arquivo de configura√ß√£o
cp config.sample.php config.php
# Configure as credenciais do banco
```

3. **Execute a instala√ß√£o autom√°tica**
```bash
# Acesse via navegador
http://seu-servidor/pulseira/install.php
```

4. **Inicie o sistema**
```bash
# Acesse a interface principal
http://seu-servidor/pulseira/
```

### Instala√ß√£o Manual

1. **Criar as tabelas do banco**
```sql
-- Execute o script SQL inclu√≠do
mysql -u usuario -p database < database.sql
```

2. **Configurar permiss√µes**
```bash
# Definir permiss√µes adequadas para o diret√≥rio
chmod 755 pulseira/
chmod 644 pulseira/*.php
```

## üóÑÔ∏è Estrutura do Banco de Dados

### Tabela: `entregas_pulseiras`
```sql
CREATE TABLE IF NOT EXISTS `entregas_pulseiras` (
  `id` int(11) NOT NULL AUTO_INCREMENT,
  `inscricao_id` int(11) NOT NULL COMMENT 'ID da inscri√ß√£o (extra√≠do do QRCode ap√≥s o ponto)',
  `qrcode_lido` text NOT NULL COMMENT 'QRCode completo lido (ex: 10.3731452383)',
  `tipo_qr` int(2) NOT NULL COMMENT 'Tipo do QRCode: 10=c√≥digo inscri√ß√£o, 20=id participante',
  `data_entrega` datetime NOT NULL DEFAULT CURRENT_TIMESTAMP,
  `data_entrega_dia` date GENERATED ALWAYS AS (DATE(`data_entrega`)) STORED,
  `status` enum('entregue','pendente') DEFAULT 'entregue',
  `observacoes` text NULL,
  `ip_dispositivo` varchar(45) NULL,
  `user_agent` text NULL,
  PRIMARY KEY (`id`),
  INDEX `idx_inscricao_id` (`inscricao_id`),
  INDEX `idx_data_entrega` (`data_entrega`),
  INDEX `idx_status` (`status`),
  INDEX `idx_tipo_qr` (`tipo_qr`),
  INDEX `idx_data_entrega_dia` (`data_entrega_dia`),
  UNIQUE KEY `unique_inscricao_dia` (`inscricao_id`, `data_entrega_dia`)
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COMMENT='Registra todas as entregas de pulseiras do evento';
```

### Tabela: `pulseiras_config`
```sql
CREATE TABLE IF NOT EXISTS `pulseiras_config` (
  `id` int(11) NOT NULL AUTO_INCREMENT,
  `sistema_ativo` tinyint(1) NOT NULL DEFAULT 1 COMMENT '1=sistema ativo, 0=inativo',
  `uma_pulseira_por_dia` tinyint(1) NOT NULL DEFAULT 1 COMMENT '1=apenas uma pulseira por dia por pessoa',
  `tipos_permitidos` varchar(50) NOT NULL DEFAULT '10,20' COMMENT 'Tipos de QR permitidos (separados por v√≠rgula)',
  `data_atualizacao` datetime NOT NULL DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP,
  `usuario_responsavel` varchar(100) NULL,
  PRIMARY KEY (`id`)
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COMMENT='Configura√ß√µes do sistema de entrega de pulseiras';
```

## üì± Uso do Sistema

### Para Operadores

1. **Iniciar Leitura**
   - Abra o sistema no smartphone
   - Clique em "Iniciar C√¢mera" ou digite manualmente
   - Aponte a c√¢mera para o QR Code

2. **Verificar Resultado**
   - ‚úÖ **Verde**: Pode retirar pulseira
   - ‚ùå **Vermelho**: N√£o pode retirar (j√° retirou ou c√≥digo inv√°lido)

3. **Confirmar Entrega**
   - Se aprovado, clique em "Confirmar Entrega"
   - Sistema registra automaticamente a opera√ß√£o

### Para Administradores

1. **Acompanhar Estat√≠sticas**
   - Dashboard com contadores em tempo real
   - Gr√°ficos de distribui√ß√£o por tipo de QR

2. **Verificar Hist√≥rico**
   - Lista das √∫ltimas entregas
   - Detalhes de cada opera√ß√£o realizada

3. **Diagn√≥sticos**
   - Acesse `/diagnostico.php` para verifica√ß√£o do sistema
   - Relat√≥rios t√©cnicos e logs de erro

## üîß Configura√ß√£o

### Par√¢metros do Sistema
```php
// Em pulseiras_config
$sistema_ativo = true;              // Ativar/desativar sistema
$uma_pulseira_por_dia = true;       // Controle de uma por dia
$tipos_permitidos = '10,20';        // Tipos de QR aceitos
```

### Personaliza√ß√£o
```php
// Em config.php
$titulo_sistema = 'Sistema de Pulseiras';
$evento_nome = 'Sal√£o do Turismo 2024';
$cores_tema = ['primary' => '#007bff', 'success' => '#28a745'];
```

## üìä API Endpoints

### POST `/`
**Verificar QR Code**
```json
{
  "action": "verificar_qr",
  "qrcode": "10.3731452383"
}
```

**Resposta de Sucesso:**
```json
{
  "success": true,
  "pode_retirar": true,
  "message": "PODE RETIRAR PULSEIRA",
  "participante": "Nome do Participante",
  "tipo_qr": 10,
  "qrcode": "10.3731452383"
}
```

### POST `/`
**Confirmar Entrega**
```json
{
  "action": "confirmar_entrega",
  "qrcode": "10.3731452383"
}
```

## ü§ù Contribui√ß√£o

1. **Fork o projeto**
2. **Crie uma branch** (`git checkout -b feature/nova-funcionalidade`)
3. **Commit suas mudan√ßas** (`git commit -am 'Adiciona nova funcionalidade'`)
4. **Push para a branch** (`git push origin feature/nova-funcionalidade`)
5. **Abra um Pull Request**

## üìÑ Licen√ßa

Este projeto est√° sob a licen√ßa MIT. Veja o arquivo `LICENSE` para mais detalhes.

## üë®‚Äçüíª Desenvolvimento

**Sistema de Entrega de Pulseiras v2.0**  
Desenvolvido para otimizar o controle de pulseiras em eventos.

### Roadmap
- [ ] PWA completa com cache offline
- [ ] Sincroniza√ß√£o autom√°tica em background
- [ ] Dashboard administrativo expandido
- [ ] Relat√≥rios em PDF/Excel
- [ ] Integra√ß√£o com sistemas de credenciamento
- [ ] Suporte a m√∫ltiplos eventos simult√¢neos

---

üí° **Dica**: Para melhor experi√™ncia, utilize em dispositivos com boa qualidade de c√¢mera e conex√£o est√°vel √† internet.
- `user_agent` - Navegador utilizado

#### Tabela: `pulseiras_config`
- `id` - ID da configura√ß√£o
- `sistema_ativo` - Se o sistema est√° ativo
- `uma_pulseira_por_dia` - Controle de uma pulseira por dia
- `tipos_permitidos` - Tipos de QR permitidos
- `data_atualizacao` - √öltima atualiza√ß√£o
- `usuario_responsavel` - Usu√°rio respons√°vel

## Instala√ß√£o

### 1. Prepara√ß√£o
```bash
# Copie os arquivos para a pasta pulseira/
# Certifique-se que o config.php principal est√° configurado
```

### 2. Instala√ß√£o Autom√°tica
Acesse: `http://seudominio.com/pulseira/install.php`

O script ir√°:
- ‚úÖ Criar as tabelas necess√°rias
- ‚úÖ Inserir configura√ß√µes padr√£o
- ‚úÖ Testar o sistema
- ‚úÖ Validar a instala√ß√£o

### 3. Verifica√ß√£o
Acesse: `http://seudominio.com/pulseira/`

## Interface do Usu√°rio

### üé® Design Responsivo
- **Cores**: Roxo (#9b59b6) como cor prim√°ria
- **Layout**: Baseado no sistema de controle de sala
- **Mobile First**: Otimizado para smartphones
- **Bootstrap 5**: Framework CSS moderno

### üì± Fluxo de Uso
1. **Iniciar c√¢mera** ou usar campo manual
2. **Ler QR Code** do participante
3. **Verificar dados** exibidos na tela
4. **Confirmar entrega** se liberado
5. **Visualizar confirma√ß√£o** com hor√°rio

### üéØ Estados Visuais
- **üü° Amarelo**: Aguardando confirma√ß√£o
- **üü¢ Verde**: Pulseira entregue com sucesso
- **üî¥ Vermelho**: N√£o pode retirar / erro
- **Efeitos**: Piscar fundo conforme resultado

## Regras de Neg√≥cio

### ‚úÖ Pode Retirar Pulseira
- QR Code tipo **10** (c√≥digo de inscri√ß√£o)
- QR Code tipo **20** (ID do participante)
- Participante encontrado no sistema
- N√£o retirou pulseira hoje

### ‚ùå N√£o Pode Retirar Pulseira
- QR Code tipo **30** ou **40**
- Participante n√£o encontrado
- J√° retirou pulseira no dia atual
- Formato de QR Code inv√°lido

### üîí Controles de Seguran√ßa
- **√önico por dia**: Constraint UNIQUE na base de dados
- **Log completo**: Todos os acessos s√£o registrados
- **Valida√ß√£o dupla**: Cliente e servidor validam
- **Hist√≥rico imut√°vel**: Registros n√£o podem ser alterados

## Tecnologias Utilizadas

### Frontend
- **HTML5**: Estrutura sem√¢ntica
- **CSS3**: Estilos e anima√ß√µes
- **JavaScript/jQuery**: Interatividade
- **Bootstrap 5**: Framework CSS
- **Font Awesome**: √çcones
- **QR Code Reader**: Biblioteca para leitura de QR

### Backend
- **PHP 7.4+**: Linguagem principal
- **PDO**: Acesso ao banco de dados
- **MySQL/MariaDB**: Banco de dados
- **JSON**: Comunica√ß√£o AJAX

## Manuten√ß√£o

### üìä Monitoramento
- Acompanhe as estat√≠sticas em tempo real
- Verifique os logs de entrega regularmente
- Monitor performance da leitura de QR

### üîß Backup
```sql
-- Backup di√°rio recomendado
mysqldump -u usuario -p base_dados entregas_pulseiras > backup_pulseiras_$(date +%Y%m%d).sql
```

### üö® Troubleshooting

#### Problema: C√¢mera n√£o funciona
- **Verificar**: HTTPS √© obrigat√≥rio para c√¢mera
- **Solu√ß√£o**: Use campo manual como alternativa

#### Problema: QR Code n√£o reconhecido
- **Verificar**: Formato XX.YYYYYYYY
- **Solu√ß√£o**: Validar dados de entrada

#### Problema: Erro de duplicata
- **Causa**: Participante j√° retirou hoje
- **Solu√ß√£o**: Sistema bloqueia automaticamente

## Compatibilidade

### üì± Dispositivos M√≥veis
- ‚úÖ Android 6.0+
- ‚úÖ iOS 10.0+
- ‚úÖ Tablets
- ‚úÖ Smartphones

### üåê Navegadores
- ‚úÖ Chrome 70+
- ‚úÖ Firefox 65+
- ‚úÖ Safari 12+
- ‚úÖ Edge 79+

## Seguran√ßa

### üîê Medidas Implementadas
- **Valida√ß√£o servidor**: Todas as regras no backend
- **Prepared Statements**: Prote√ß√£o contra SQL Injection
- **Sanitiza√ß√£o**: Limpeza de dados de entrada
- **Log de auditoria**: Rastreamento completo

### üõ°Ô∏è Recomenda√ß√µes
- Use HTTPS em produ√ß√£o
- Configure firewall adequadamente
- Monitore logs de acesso
- Backup regular dos dados

## Suporte

Para problemas ou d√∫vidas:
1. Verifique a documenta√ß√£o completa
2. Consulte os logs do sistema
3. Execute o script de diagn√≥stico
4. Entre em contato com o suporte t√©cnico

---

**Sistema de Entrega de Pulseiras v1.0**  
*Sal√£o do Turismo - 2025*
